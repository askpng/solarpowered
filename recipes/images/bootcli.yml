---
# yaml-language-server: $schema=https://schema.blue-build.org/recipe-v1.json

# enter image name here
name: base-cli
# enter image description here
description: base-cli image

# this template is for use with
# shared/base.yml

# defines base image
# ---
base-image: quay.io/fedora/fedora-bootc
# base-image: quay.io/fedora/fedora-silverblue # needs Cosign.sh

# definves image major version
# ---
image-version: 41

modules:
  - from-file: shared/files.yml
  
  - type: rpm-ostree
    repos:
      # starship & topgrade
      - https://copr.fedorainfracloud.org/coprs/shdwchn10/AllTheTools/repo/fedora-%OS_VERSION%/shdwchn10-AllTheTools-fedora-%OS_VERSION%.repo
      # ublue-os staging
      - https://copr.fedorainfracloud.org/coprs/ublue-os/staging/repo/fedora-%OS_VERSION%/ublue-os-staging-fedora-%OS_VERSION%.repo
    install:
      # CLI utilities
      - fish
      - fzf
      - gum
      - just
      - kitty
      - lm_sensors
      - lzip
      - squashfs-tools
      - starship
      - symlinks
      - tcpdump
      - topgrade
      - traceroute
      - wireguard-tools
      - wl-clipboard
      - zstd

  - type: script
    snippets:
      - 'rpm-ostree install https://github.com/sigstore/cosign/releases/latest/download/cosign-$(curl https://api.github.com/repos/sigstore/cosign/releases/latest | grep tag_name | cut -d : -f2 | tr -d "v\", ")}-1.x86_64.rpm'
      
  - type: signing
